"use strict";var categoriesController=function(){function e(e){function t(){$("#search").keypress(function(t){13==t.which&&e.redirect("#/search")})}var n=firebase.database().ref();n.on("value",function(i){templates.get("categories").then(function(a){e.$element().html(a(i.val())),n.off("value"),t()})})}function t(e){function t(){$("#search").keypress(function(t){13==t.which&&e.redirect("#/search")})}var n=e.params.id,i=firebase.database().ref("books");i.orderByChild("bookCategory").equalTo(n).once("value",function(n){templates.get("category").then(function(a){e.$element().html(a(n.val())),i.off(),t()})})}function n(e){function t(){var e=document.getElementById("cartBtn"),t=document.getElementById("price").innerText,n=document.getElementById("itemName").innerText,i=document.getElementById("itemAuthor").innerText,a=document.getElementById("itemImage").src,r=window.location.href,o=carty({storage:carty.storage.localStorage(),currency:"USD"});e.addEventListener("click",function(e){o.add({id:n,label:i,price:t,quantity:1,author:i,title:n,imageUrl:a,itemUrl:r}),toastr.success(n+" is added to your cart")})}function n(){var e=o,t=document.getElementById("tb-comment"),n=document.getElementById("btn-add-comment");document.getElementById("alertMsg");firebase.auth().onAuthStateChanged(function(i){i?n.addEventListener("click",function(n){var i=firebase.auth().currentUser,a=i.displayName,r=i.photoURL,o=t.value,c=(new Date).toString().split(" ").splice(1,3).join(" ");e.push({comment:o,photoUrl:r,author:a,date:c}),toastr.success("Your Comment is Added!")}):n.addEventListener("click",function(e){toastr.warning("Register or LogIn to add a comment")})})}function i(){var e=document.getElementById("wishlistBtn"),t=document.getElementById("price").innerText,n=document.getElementById("itemAuthor").innerText,i=document.getElementById("itemImage").src,a=window.location.href,o=document.getElementById("itemName").innerText;e.addEventListener("click",function(e){}),firebase.auth().onAuthStateChanged(function(c){c?e.addEventListener("click",function(e){var c=firebase.auth().currentUser,s=c.uid,d=firebase.database().ref().child("wishlist"),u=d.child(s);if(u.on("value",function(e){e.val()}),null==data)d.child(s).set({id:r,title:o,author:n,price:t,image:i,url:a}),toastr.success(o+"is added to your wishlist");else{u.orderByChild("id").equalTo(r).once("value",function(e){null==e.val()?(u.push({id:r,title:o,author:n,price:t,image:i,url:a}),toastr.success(o+" is added to your wishlist")):toastr.warning(o+" is already added in your wishlist!")})}}):e.addEventListener("click",function(e){toastr.warning("LogIn or Register First!")})})}function a(){$("#search").keypress(function(t){13==t.which&&e.redirect("#/search")})}var r=e.params.id,o=firebase.database().ref().child("books").child(r);o.on("value",function(r){var o=r.val();templates.get("book").then(function(r){e.$element().html(r(o)),n(),t(),i(),a()})})}return{all:e,one:t,book:n}}();