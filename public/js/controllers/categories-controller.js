"use strict";var categoriesController=function(){function e(e){function t(){$("#search").keypress(function(t){13==t.which&&(e.redirect("#/search"),$(".navbar-collapse").collapse("hide"))})}var n=firebase.database().ref();n.on("value",function(a){templates.get("categories").then(function(i){e.$element().html(i(a.val())),n.off("value"),t()})})}function t(e){function t(){$("#search").keypress(function(t){13==t.which&&(e.redirect("#/search"),$(".navbar-collapse").collapse("hide"))})}var n=e.params.id,a=firebase.database().ref("books");a.orderByChild("bookCategory").equalTo(n).once("value",function(n){templates.get("category").then(function(i){e.$element().html(i(n.val())),a.off(),t()})})}function n(e){function t(){var e=document.getElementById("cartBtn"),t=document.getElementById("price").innerText,n=document.getElementById("itemName").innerText,a=document.getElementById("itemAuthor").innerText,i=document.getElementById("itemImage").src,o=window.location.href,r=carty({storage:carty.storage.localStorage(),currency:"USD"});e.addEventListener("click",function(e){r.add({id:n,label:a,price:t,quantity:1,author:a,title:n,imageUrl:i,itemUrl:o}),toastr.success(n+" is added to your cart")})}function n(){var e=r,t=document.getElementById("tb-comment"),n=document.getElementById("btn-add-comment");document.getElementById("alertMsg");firebase.auth().onAuthStateChanged(function(a){a?n.addEventListener("click",function(n){var a=firebase.auth().currentUser,i=a.displayName,o=a.photoURL,r=t.value,c=(new Date).toString().split(" ").splice(1,3).join(" ");e.push({comment:r,photoUrl:o,author:i,date:c}),toastr.success("Your Comment is Added!")}):n.addEventListener("click",function(e){toastr.warning("Register or LogIn to add a comment")})})}function a(){var e=document.getElementById("wishlistBtn"),t=document.getElementById("price").innerText,n=document.getElementById("itemAuthor").innerText,a=document.getElementById("itemImage").src,i=window.location.href,r=document.getElementById("itemName").innerText;e.addEventListener("click",function(e){}),firebase.auth().onAuthStateChanged(function(c){c?e.addEventListener("click",function(e){var c=firebase.auth().currentUser,s=c.uid,l=firebase.database().ref().child("wishlist"),d=l.child(s);if(d.on("value",function(e){e.val()}),null==data)l.child(s).set({id:o,title:r,author:n,price:t,image:a,url:i}),toastr.success(r+"is added to your wishlist");else{d.orderByChild("id").equalTo(o).once("value",function(e){null==e.val()?(d.push({id:o,title:r,author:n,price:t,image:a,url:i}),toastr.success(r+" is added to your wishlist")):toastr.warning(r+" is already added in your wishlist!")})}}):e.addEventListener("click",function(e){toastr.warning("LogIn or Register First!")})})}function i(){$("#search").keypress(function(t){13==t.which&&(e.redirect("#/search"),$(".navbar-collapse").collapse("hide"))})}var o=e.params.id,r=firebase.database().ref().child("books").child(o);r.on("value",function(o){var r=o.val();templates.get("book").then(function(o){e.$element().html(o(r)),n(),t(),a(),i()})})}return{all:e,one:t,book:n}}();